## 目标
- 在资产详情页支持对该资产的编辑与删除（弹窗与确认机制，统一简约风样式）
- 在资产详情页新增“资产变更详情”时间线，记录历史变更：时间点、变更前金额、变更后金额、差值（可附备注）

## 数据模型（Prisma 扩展）
- 新增 `AssetChange`（资产变更日志）
  - 字段：`id`，`assetId`，`beforeAmount(Decimal 18,2)`，`afterAmount(Decimal 18,2)`，`diff(Decimal 18,2)`，`at(DateTime)`，`notes?`，`createdAt`，`updatedAt`
  - 关系：`assetId → Asset(id)`；索引 `(assetId, at)`；`diff = after - before` 在服务端计算

## API 设计
- 资产编辑/删除（详情页内使用）
  - `PUT /api/assets/:id`：沿用现有接口，编辑成功后自动写入一条 `AssetChange`（用编辑前后的 `amount` 计算）
  - `DELETE /api/assets/:id`：删除资产（确认弹窗后执行）；成功后重定向到资产列表（前端处理）
- 变更时间线读取与新增
  - `GET /api/assets/:id/changes`：返回该资产的变更日志列表（按时间倒序）
  - `POST /api/assets/:id/changes`（可选）：手工记录一条变更（如修正错账）；登录校验 + Zod 校验
- 校验（Zod）
  - `AssetChangeCreateSchema`：`beforeAmount(number)`，`afterAmount(number)`，`notes?:string`，服务端计算 `diff` 与 `at`（当前时刻）

## 前端页面与交互
- 资产详情页 `app/assets/[id]/page.tsx`
  - 头部操作区：新增“编辑”和“删除”按钮
    - 编辑弹窗：可修改名称、类型、基础金额、币种、估值日期、备注；提交 `PUT /api/assets/:id`
    - 删除确认弹窗：确认后调用 `DELETE /api/assets/:id`，成功后返回列表
  - 资产变更详情卡片（时间线）
    - 列表项显示：`at` 时间点、`before → after`、`diff`（带正负颜色）、`notes`
    - 顶部总览：最近 N 次变更统计（可选显示）
    - 可选新增变更表单（用于手工记录）
- 样式与组件
  - 复用现有 `Card/Button/Input/Modal/Alert`，新增简约“时间线”列表样式（左侧圆点 + 竖线）
  - 颜色：`diff > 0` 用 `text-green-600`，`diff < 0` 用 `text-red-600`

## 安全与一致性
- 所有写操作（编辑、删除、手工新增变更）统一登录校验（Cookie）
- 金额字段使用 Decimal 存储，前端 `number` 录入，服务端校验与转换
- 自动记录变更：仅当 `amount` 有变化时写入 `AssetChange`，避免无意义日志

## 实施步骤
1. 扩展 Prisma：新增 `AssetChange` 模型；生成并推送迁移
2. 接口实现：
   - 在现有 `PUT /api/assets/:id` 内加入变更记录逻辑（读取更新前资产，若 `amount` 变化则写入日志）
   - 新增 `GET /api/assets/:id/changes` 与可选 `POST /api/assets/:id/changes`，加入 Zod 校验与登录校验
3. 前端详情页：
   - 加入“编辑/删除”按钮与弹窗；提交后刷新页面与反馈
   - 新增“资产变更详情”卡片；渲染时间线，拉取 `GET /api/assets/:id/changes`
   - 可选提供手工新增变更的表单与提交
4. 验证：本地前端直连数据库，完成编辑、删除与时间线展示验证；未登录写操作提示登录

## 验收标准
- 资产详情页支持编辑与删除；删除后返回列表
- 自动记录变更日志并在时间线展示；显示时间点、前后金额与差值（含正负色）
- 错误提示与交互统一简约风；未登录写操作被阻止并提示登录
