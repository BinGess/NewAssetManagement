## 项目目标

* 构建一个可通过网页访问的个人/企业资产管理系统

* 支持添加资产与负债，含常用类型预置和自定义扩展

* 提供整体资产信息表与净值、分类统计与趋势图

* 支持快速部署与服务端数据持久化（本地/云端）

## 技术栈选择

* 前端：Next.js + TypeScript + Tailwind CSS（或 Ant Design 以加速表格/表单）

* 服务端：Next.js API Routes（同仓统一开发，降低复杂度）

* ORM：Prisma（开发用 SQLite，生产切换 Postgres/MySQL）

* 校验：Zod（前后端一致的输入校验）

* 部署：Docker + docker-compose 一键启动；或 Vercel（前端）+ Neon/Render（数据库/后端）

## 数据模型（Prisma）

* Asset（资产）

  * `id`，`name`，`typeId`，`amount`，`currency`，`valuationDate`，`notes`，`createdAt`，`updatedAt`

* Liability（负债）

  * `id`，`name`，`typeId`，`amount`，`interestRate`，`dueDate`，`notes`，`createdAt`，`updatedAt`

* AssetType（资产类型）

  * `id`，`code`，`label`（支持启用/禁用、排序）

* LiabilityType（负债类型）

  * `id`，`code`，`label`

* Snapshot（可选：每日/任意时间点净值快照，用于趋势）

  * `id`，`totalAssets`，`totalLiabilities`，`netWorth`，`at`

## 预置类型

* 资产类型：`现金/储蓄`、`活期/定期`、`股票`、`基金`、`债券`、`公积金/养老金`、`房产`、`车辆`、`贵金属`、`加密货币`、`应收款`、`其他`

* 负债类型：`房贷`、`车贷`、`信用卡`、`消费贷`、`学生贷`、`个人借款`、`应付款`、`税务负债`、`其他`

* 支持在“类型管理”页新增/禁用类型

## API 设计（REST）

* `GET /api/assets`：分页/筛选资产列表；`POST /api/assets`：创建资产

* `GET /api/assets/:id`；`PUT /api/assets/:id`；`DELETE /api/assets/:id`

* `GET /api/liabilities`；`POST /api/liabilities`；同上 CRUD

* `GET /api/asset-types`；`POST /api/asset-types`；`GET/PUT/DELETE /api/asset-types/:id`

* `GET /api/liability-types`；同上 CRUD

* `GET /api/summary`：返回总资产、总负债、净值、按类型汇总、近30日趋势（依赖 Snapshot 或实时聚合）

## 前端页面与交互

* `Dashboard`：卡片展示总资产/负债/净值；分类占比饼图；净值趋势折线图

* `资产列表`：表格（名称/类型/金额/币种/估值日期）；搜索/筛选；新增/编辑/删除弹窗表单

* `负债列表`：同资产列表；含利率/到期日字段

* `类型管理`：资产/负债类型的查看、启用/禁用、创建

* 统一表单校验与错误提示；金额与日期组件；可选多币种（默认 `CNY`）

## 数据存储与迁移

* `.env` 管理 `DATABASE_URL`（开发默认 SQLite，生产 Postgres）

* `prisma schema` 定义模型；`prisma migrate` 管理版本化迁移

* 预置种子脚本：初始化资产/负债类型；示例数据（可选）

## 快速部署方案

* 方案 A：Docker 一键

  * `Dockerfile`（Node 运行）+ `docker-compose.yml`（`web` + `db`：Postgres）

  * 命令：`docker compose up -d` → 自动运行迁移与种子

* 方案 B：无容器快速启动（开发）

  * `npm i` → `npx prisma migrate dev` → `npm run dev`

* 方案 C：云托管

  * 前端：Vercel；数据库：Neon（Postgres 无服务器）；后端同 Next.js API Routes

## 安全与合规

* 不在仓库提交任何密钥；`.env` 通过模板示例

* 基于 Zod 的输入校验与服务端检查；防止负数/非法日期等

* CORS 与速率限制（如将来开放跨域访问）

## 测试与验证

* 单元测试：API 层（Jest/Vitest）

* 集成测试：对 `summary` 聚合正确性校验

* 端到端测试（可选）：Playwright 验证主要流程（新增资产/负债、查看统计）

## 目录结构（拟定）

* `app/` 或 `pages/`：前端页面与 API 路由

* `components/`：UI 组件（表格、表单、图表）

* `lib/`：工具（格式化、金额计算、校验）

* `prisma/`：`schema.prisma`，`migrations/`，`seed.ts`

* `docker-compose.yml`，`Dockerfile`，`README.md`，`.env.example`

## 实施步骤

1. 初始化项目与依赖（Next.js、Prisma、Tailwind/AntD、Zod）
2. 设计并实现 Prisma 模型与迁移；编写种子脚本
3. 实现 API：资产/负债/类型 CRUD 与 `summary` 聚合
4. 搭建前端页面：Dashboard、资产列表、负债列表、类型管理
5. 打磨交互与校验；表格筛选、排序、分页
6. 增加测试用例与示例数据；完善 README
7. 提供 Docker 与云部署配置；验证生产数据库切换

## 交付验收标准

* 可在本地运行（包含示例数据），页面完成主要流程

* 资产/负债 CRUD 稳定；`summary` 返回净值与分类汇总正确

* 一键容器化启动与云端环境变量配置文档齐全

## 后续扩展

* 多币种与汇率换算；多账户/多用户；导入导出（CSV/Excel）

* 权限与登录（简单密码或 OAuth）；定时快照与自动汇总

* 高级图表与预算/现金流模块

部署方案选择方案A，按照这个执行；网页端，还需要登录界面
